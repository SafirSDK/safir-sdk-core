<?xml version="1.0" encoding="utf-8"?>
<object xmlns="urn:safir-dots-unit">
  <name>DoseTest.Items.TestCase</name>
  <members>
    <member>
      <name>Description</name>
      <value>Register message, entity and service handlers, then dispatching is inhibited so that the queues are stalled.
             This can be used to check the functionality of dose_monitor. </value>
    </member>
    <member>
      <name>Expectation</name>
      <value>dose_monitor takes the appropriate actions</value>
    </member>
    <member>
      <name>TestCaseSetupActions</name>
        <arrayElements>
          
          <arrayElement>
            <object>
              <name>DoseTest.Action</name>
              <members>
                <member>
                  <name>Partner</name>
                  <value>0</value>
                </member>
                <member>
                  <name>ActionKind</name>
                  <value>DoseTest.ActionEnum.RegisterServiceHandler</value>
                </member>
                <member>
                  <name>TypeId</name>
                  <value>DoseTest.GlobalService</value>
                </member>
                <member>
                  <name>Handler</name>
                  <value>CONSUMER_0_HANDLER</value>
                </member>
                <member>
                  <name>Consumer</name>
                  <value>0</value>
                </member>
              </members>
            </object>
          </arrayElement>
          <arrayElement>
            <object>
              <name>DoseTest.Action</name>
              <members>
                <member>
                  <name>Partner</name>
                  <value>0</value>
                </member>
                <member>
                  <name>ActionKind</name>
                  <value>DoseTest.ActionEnum.RegisterServiceHandler</value>
                </member>
                <member>
                  <name>TypeId</name>
                  <value>DoseTest.GlobalService</value>
                </member>
                <member>
                  <name>Handler</name>
                  <value>CONSUMER_1_HANDLER</value>
                </member>
                <member>
                  <name>Consumer</name>
                  <value>1</value>
                </member>
              </members>
            </object>
          </arrayElement>

          <arrayElement>
            <object>
              <name>DoseTest.Action</name>
              <members>
                <member>
                  <name>Partner</name>
                  <value>0</value>
                </member>
                <member>
                  <name>ActionKind</name>
                  <value>DoseTest.ActionEnum.RegisterEntityHandler</value>
                </member>
                <member>
                  <name>TypeId</name>
                  <value>DoseTest.GlobalEntity</value>
                </member>
                <member>
                  <name>Handler</name>
                  <value>CONSUMER_2_HANDLER</value>
                </member>
                <member>
                  <name>InstanceIdPolicy</name>
                  <value>Safir.Dob.InstanceIdPolicy.RequestorDecidesInstanceId</value>
                </member>
                <member>
                  <name>Consumer</name>
                  <value>2</value>
                </member>
              </members>
            </object>
          </arrayElement>

          <arrayElement>
            <object>
              <name>DoseTest.Action</name>
              <members>
                <member>
                  <name>Partner</name>
                  <value>0</value>
                </member>
                <member>
                  <name>ActionKind</name>
                  <value>DoseTest.ActionEnum.SubscribeMessage</value>
                </member>
                <member>
                  <name>TypeId</name>
                  <value>DoseTest.GlobalMessage</value>
                </member>
                <member>
                  <name>Channel</name>
                  <value>CONSUMER_0_CHANNEL</value>
                </member>
                <member>
                  <name>IncludeSubclasses</name>
                  <value>true</value>
                </member>
                <member>
                  <name>Consumer</name>
                  <value>0</value>
                </member>
              </members>
            </object>
          </arrayElement>

          <arrayElement>
            <object>
              <name>DoseTest.Action</name>
              <members>
                <member>
                  <name>Partner</name>
                  <value>0</value>
                </member>
                <member>
                  <name>ActionKind</name>
                  <value>DoseTest.ActionEnum.SubscribeMessage</value>
                </member>
                <member>
                  <name>TypeId</name>
                  <value>DoseTest.GlobalMessage</value>
                </member>
                <member>
                  <name>Channel</name>
                  <value>CONSUMER_1_CHANNEL</value>
                </member>
                <member>
                  <name>IncludeSubclasses</name>
                  <value>true</value>
                </member>
                <member>
                  <name>Consumer</name>
                  <value>1</value>
                </member>
              </members>
            </object>
          </arrayElement>

        </arrayElements>
    </member>
    <member>
      <name>TestActions</name>
      <arrayElements>
        
        <!-- Get something into in-queues -->
        <!-- service request -->
        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>Partner</name>
                <value>1</value>
              </member>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.ServiceRequest</value>
              </member>
              <member>
                <name>Object</name>
                <object>
                  <name>DoseTest.GlobalService</name>
                </object>
              </member>
              <member>
                <name>Handler</name>
                <value>CONSUMER_0_HANDLER</value>
              </member>
              <member>
                <name>Consumer</name>
                <value>1</value>
              </member>
            </members>
          </object>
        </arrayElement>
        <!-- entity request-->
        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>Partner</name>
                <value>1</value>
              </member>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.CreateRequest</value>
              </member>
              <member>
                <name>Instance</name>
                <value>987654</value>
              </member>
              <member>
                <name>Object</name>
                <object>
                  <name>DoseTest.GlobalEntity</name>
                  <members>
                    <member>
                      <name>Info</name>
                      <value>Created</value>
                    </member>
                  </members>
                </object>
              </member>
              <member>
                <name>Handler</name>
                <value>CONSUMER_2_HANDLER</value>
              </member>
              <member>
                <name>Consumer</name>
                <value>1</value>
              </member>
            </members>
          </object>
        </arrayElement>
        <!-- message -->
        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>Partner</name>
                <value>1</value>
              </member>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.SendMessage</value>
              </member>
              <member>
                <name>Channel</name>
                <value>CONSUMER_0_CHANNEL</value>
              </member>
              <member>
                <name>Object</name>
                <object>
                  <name>DoseTest.GlobalMessage</name>
                  <members>
                    <member>
                      <name>Info</name>
                      <value>Global Message</value>
                    </member>
                  </members>
                </object>
              </member>
              <member>
                <name>Consumer</name>
                <value>1</value>
              </member>
            </members>
          </object>
        </arrayElement>

        <!-- Inhibit dispatch-->
        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>Partner</name>
                <value>0</value>
              </member>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.InhibitDispatch</value>
              </member>
              <member>
                <name>Inhibit</name>
                <value>True</value>
              </member>
            </members>
          </object>
        </arrayElement>

        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>Partner</name>
                <value>1</value>
              </member>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.SendMessage</value>
              </member>
              <member>
                <name>Channel</name>
                <value>CONSUMER_0_CHANNEL</value>
              </member>
              <member>
                <name>Object</name>
                <object>
                  <name>DoseTest.GlobalMessage</name>
                  <members>
                    <member>
                      <name>Info</name>
                      <value>Global Message</value>
                    </member>
                  </members>
                </object>
              </member>
              <member>
                <name>Consumer</name>
                <value>1</value>
              </member>
            </members>
          </object>
        </arrayElement>

        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>Partner</name>
                <value>1</value>
              </member>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.CreateRequest</value>
              </member>
              <member>
                <name>Instance</name>
                <value>5656</value>
              </member>
              <member>
                <name>Object</name>
                <object>
                  <name>DoseTest.GlobalEntity</name>
                  <members>
                    <member>
                      <name>Info</name>
                      <value>Created</value>
                    </member>
                  </members>
                </object>
              </member>
              <member>
                <name>Handler</name>
                <value>CONSUMER_2_HANDLER</value>
              </member>
              <member>
                <name>Consumer</name>
                <value>1</value>
              </member>
            </members>
          </object>
        </arrayElement>

        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>Partner</name>
                <value>1</value>
              </member>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.ServiceRequest</value>
              </member>
              <member>
                <name>Object</name>
                <object>
                  <name>DoseTest.GlobalService</name>
                </object>
              </member>
              <member>
                <name>Handler</name>
                <value>CONSUMER_0_HANDLER</value>
              </member>
              <member>
                <name>Consumer</name>
                <value>1</value>
              </member>
            </members>
          </object>
        </arrayElement>        
        
        <arrayElement>
          <object>
            <name>DoseTest.Action</name>
            <members>
              <member>
                <name>ActionKind</name>
                <value>DoseTest.ActionEnum.Sleep</value>
              </member>
              <member>
                <name>SleepDuration</name>
                <value>600</value>
              </member>
            </members>
          </object>
        </arrayElement>
      </arrayElements>
    </member>
  </members>
</object>

