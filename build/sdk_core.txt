#command          directory                                config    extra_config
#extra_config is only built on windows.
#config is normally Release, but on windows we sometimes want the 
#debug configuration to be built too (e.g. for dlls that exists in two "flavors")

#CONFIG
build_dir        build/config                              Release

#check that patches have been applied
build_dir        build/patch_check                         Release

#LLUF
build_dir        src/lluf/lluf_build_helpers.ss/src         Release
build_dir        src/lluf/lluf_config.ss/src                Release          Debug
build_dir        src/lluf/lluf_config_dump.ss/src           Release
build_dir        src/lluf/lluf_crash_reporter.ss/src        Release
build_dir        src/lluf/lluf_startup_synchronizer.ss/src  RelWithDebInfo
build_dir        src/lluf/lluf_utils.ss/src                 RelWithDebInfo   Debug
build_dir        src/lluf/lluf_logger_control.ss/src        RelWithDebInfo
build_dir        src/lluf/lluf_crash_dump_monitor.ss/src    RelWithDebInfo
build_dir        src/lluf/lluf_id.ss/src                    RelWithDebInfo

#run the lluf unit tests
run_test_suite   src/lluf/lluf_config.ss/tests                 lluf_config_tests
run_test_suite   src/lluf/lluf_crash_reporter.ss/tests         lluf_crash_reporter_tests
run_test_suite   src/lluf/lluf_crash_dump_monitor.ss/tests     lluf_crash_dump_monitor_tests
run_test_suite   src/lluf/lluf_startup_synchronizer.ss/tests   lluf_startup_synchronizer_tests
run_test_suite   src/lluf/lluf_utils.ss/tests                  lluf_tests
run_test_suite   src/lluf/lluf_id.ss/tests                     lluf_id_tests

#LOGGING
build_dir        src/logging/logging_library.ss/src        RelWithDebInfo
build_dir        src/logging/logging_cpp.ss/src            RelWithDebInfo   Debug
build_dir        src/logging/logging_dotnet.ss/src         RelWithDebInfo
build_dir        src/logging/logging_java.ss/src           RelWithDebInfo
build_dir        src/logging/logging_ada.ss/src            RelWithDebInfo

#LOGGING unit tests
run_test_suite   src/logging/logging_test.ss               logging_tests
 
#Distribution
build_dir        src/distribution/communication.ss/src         RelWithDebInfo Debug
build_dir        src/distribution/system_picture.ss/src        RelWithDebInfo Debug

#Distribution unit tests
run_test_suite   src/distribution/communication.ss/tests/unit_tests     communication_unit_tests
run_test_suite   src/distribution/system_picture.ss/tests/unit_tests    system_picture_tests

#DOTS
build_dir        src/dots/dots_internal.ss/src             RelWithDebInfo   Debug
run_test_suite   src/dots/dots_internal.ss/tests           dots_internal_test_suite
build_dir        src/dots/dots_kernel.ss/src               RelWithDebInfo
build_dir        src/dots/dots_configuration_check.ss/src  RelWithDebInfo
build_dir        src/dots/dots_schema_validator.ss         RelWithDebInfo
build_dir        src/dots/dots_cpp.ss/src                  RelWithDebInfo   Debug
run_test_suite   src/dots/dots_cpp.ss/tests/constants_test dots_cpp_constants_test
build_dir        src/dots/dots_dotnet.ss/src               RelWithDebInfo
build_dir        src/dots/dots_ada.ss                      RelWithDebInfo
build_dir        src/dots/dots_java.ss/src                 RelWithDebInfo
build_dir        src/dots/dots_v.ss                        RelWithDebInfo
build_dir        src/dots/dots_depends.ss                  RelWithDebInfo

#Control
build_dir        src/control/control_utils.ss/src          RelWithDebInfo Debug 
build_dir        src/control/control.ss/src                RelWithDebInfo

#Control unit tests
run_test_suite   src/control/control_utils.ss/tests/unit_tests        control_utils_tests
run_test_suite   src/control/control.ss/tests              control_tests


#COPY DOB FILES
copy_dob_files   src/dose/dose_dou.ss/data                 safir_core
copy_dob_files   src/dose/dose_dou.ss/config               safir_core/config

copy_dob_files   src/swre/swre_dou.ss/data                 safir_core

copy_dob_files   src/foreach/foreach_dou.ss/data           safir_core
copy_dob_files   src/foreach/foreach_dou.ss/config         safir_core/config

copy_dob_files   src/douf/douf_dou.ss/config               safir_core/config

copy_dob_files   src/olib/olib_dou.ss/data                 safir_core

copy_dob_files   src/dope/dope_dou.ss/data                 safir_core
copy_dob_files   src/dope/dope_dou.ss/config               safir_core/config

#run dobmake to build dots_generated dlls/libs
dobmake

#dots_kernel tests need dou files.
run_test_suite   src/dots/dots_kernel.ss/tests             dots_kernel_tests

#DOSE
build_dir        src/dose/dose_internal.ss/src             RelWithDebInfo   Debug
run_test_suite   src/dose/dose_internal.ss/tests           dose_internal_tests
build_dir        src/dose/dose_dll.ss/src                  RelWithDebInfo
build_dir        src/dose/dose_cpp.ss/src                  RelWithDebInfo   Debug
build_dir        src/dose/dose_main.ss/src                 RelWithDebInfo
run_test_suite   src/dose/dose_main.ss/tests               dose_main_tests
build_dir        src/dose/dose_dotnet.ss/src               RelWithDebInfo
build_dir        src/dose/dose_java.ss/src                 RelWithDebInfo
build_dir        src/dose/dose_ada.ss                      RelWithDebInfo
#TODO cmake file will move to src dir.

build_dir        src/dose/dose_sate.ss/src                 RelWithDebInfo
build_dir        src/dose/dose_dobexplorer.ss/src          RelWithDebInfo

#DOUF
build_dir        src/douf/douf_time_library.ss/src         RelWithDebInfo
build_dir        src/douf/douf_cpp.ss/src                  RelWithDebInfo   Debug
build_dir        src/douf/douf_dotnet.ss/src               RelWithDebInfo
build_dir        src/douf/douf_ada.ss                      RelWithDebInfo
build_dir        src/douf/douf_java.ss/src                 RelWithDebInfo
run_test_suite   src/douf/douf_test.ss/                    douf_tests

#SWRE
build_dir        src/swre/swre_library.ss/src              RelWithDebInfo
build_dir        src/swre/swre_cpp.ss/src                  RelWithDebInfo   Debug
build_dir        src/swre/swre_dotnet.ss/src               RelWithDebInfo
build_dir        src/swre/swre_java.ss/src                 RelWithDebInfo
build_dir        src/swre/swre_ada.ss/                     RelWithDebInfo
build_dir        src/swre/swre_backdoor.ss/src             RelWithDebInfo

#FOREACH
build_dir        src/foreach/foreach.ss/src                RelWithDebInfo

#OLIB
build_dir        src/olib/olib_code.ss/src                 RelWithDebInfo   Debug

#DOPE
build_dir        src/dope/dope_main.ss/src                 RelWithDebInfo

#swre tests need dope, so we can't run it until now
run_test_suite   src/swre/swre_test.ss                     swre_test

run_test_suite   src/tests/stop_orders_at_exit             stop_orders_at_exit

#Run static header checks to ensure only "good" headers have been included
run_test_suite   src/tests/header_check                    header_check

build_dir        docs/doxygen                              Release

#This will install the code examples under sdk/docs
build_dir        docs/examples                             Release
